#!/bin/bash
set -e

check_installed() {
    command -v go &>/dev/null
}

check_configured() {
    # Check if Go tools are installed
    command -v gopls &>/dev/null
}

install() {
    # Go binary installed via system package manager
    :
}

configure() {
    if ! command -v go &>/dev/null; then
        echo "Go not installed, skipping Go tools"
        return
    fi

    echo "Installing Go tools..."
    go install golang.org/x/tools/gopls@latest
    go install github.com/incu6us/goimports-reviser/v3@latest
    go install mvdan.cc/gofumpt@latest
}

update() {
    if ! command -v go &>/dev/null; then
        echo "Go not installed, skipping Go tools update"
        return
    fi

    echo "Updating Go tools..."
    go install golang.org/x/tools/gopls@latest
    go install github.com/incu6us/goimports-reviser/v3@latest
    go install mvdan.cc/gofumpt@latest
}

# Main (only run when executed directly, not when sourced)
if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    install
    configure
fi
